var s,l,F,S,u=function(e,t){return{name:e,value:t===void 0?-1:t,delta:0,entries:[],id:"v1-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},g=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var i=new PerformanceObserver(function(r){return r.getEntries().map(t)});return i.observe({type:e,buffered:!0}),i}}catch{}},y=function(e,t){var i=function r(n){n.type!=="pagehide"&&document.visibilityState!=="hidden"||(e(n),t&&(removeEventListener("visibilitychange",r,!0),removeEventListener("pagehide",r,!0)))};addEventListener("visibilitychange",i,!0),addEventListener("pagehide",i,!0)},h=function(e){addEventListener("pageshow",function(t){t.persisted&&e(t)},!0)},m=typeof WeakSet=="function"?new WeakSet:new Set,f=function(e,t,i){var r;return function(){t.value>=0&&(i||m.has(t)||document.visibilityState==="hidden")&&(t.delta=t.value-(r||0),(t.delta||r===void 0)&&(r=t.value,e(t)))}},q=function(e,t){var i,r=u("CLS",0),n=function(a){a.hadRecentInput||(r.value+=a.value,r.entries.push(a),i())},o=g("layout-shift",n);o&&(i=f(e,r,t),y(function(){o.takeRecords().map(n),i()}),h(function(){r=u("CLS",0),i=f(e,r,t)}))},d=-1,w=function(){return document.visibilityState==="hidden"?0:1/0},T=function(){y(function(e){var t=e.timeStamp;d=t},!0)},E=function(){return d<0&&(d=w(),T(),h(function(){setTimeout(function(){d=w(),T()},0)})),{get timeStamp(){return d}}},A=function(e,t){var i,r=E(),n=u("FCP"),o=g("paint",function(a){a.name==="first-contentful-paint"&&(o&&o.disconnect(),a.startTime<r.timeStamp&&(n.value=a.startTime,n.entries.push(a),m.add(n),i()))});o&&(i=f(e,n,t),h(function(a){n=u("FCP"),i=f(e,n,t),requestAnimationFrame(function(){requestAnimationFrame(function(){n.value=performance.now()-a.timeStamp,m.add(n),i()})})}))},p={passive:!0,capture:!0},P=new Date,b=function(e,t){s||(s=t,l=e,F=new Date,k(removeEventListener),C())},C=function(){if(l>=0&&l<F-P){var e={entryType:"first-input",name:s.type,target:s.target,cancelable:s.cancelable,startTime:s.timeStamp,processingStart:s.timeStamp+l};S.forEach(function(t){t(e)}),S=[]}},D=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;e.type=="pointerdown"?function(i,r){var n=function(){b(i,r),a()},o=function(){a()},a=function(){removeEventListener("pointerup",n,p),removeEventListener("pointercancel",o,p)};addEventListener("pointerup",n,p),addEventListener("pointercancel",o,p)}(t,e):b(t,e)}},k=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach(function(t){return e(t,D,p)})},I=function(e,t){var i,r=E(),n=u("FID"),o=function(c){c.startTime<r.timeStamp&&(n.value=c.processingStart-c.startTime,n.entries.push(c),m.add(n),i())},a=g("first-input",o);i=f(e,n,t),a&&y(function(){a.takeRecords().map(o),a.disconnect()},!0),a&&h(function(){var c;n=u("FID"),i=f(e,n,t),S=[],l=-1,s=null,k(addEventListener),c=o,S.push(c),C()})},R=function(e,t){var i,r=E(),n=u("LCP"),o=function(v){var L=v.startTime;L<r.timeStamp&&(n.value=L,n.entries.push(v)),i()},a=g("largest-contentful-paint",o);if(a){i=f(e,n,t);var c=function(){m.has(n)||(a.takeRecords().map(o),a.disconnect(),m.add(n),i())};["keydown","click"].forEach(function(v){addEventListener(v,c,{once:!0,capture:!0})}),y(c,!0),h(function(v){n=u("LCP"),i=f(e,n,t),requestAnimationFrame(function(){requestAnimationFrame(function(){n.value=performance.now()-v.timeStamp,m.add(n),i()})})})}},B=function(e){var t,i=u("TTFB");t=function(){try{var r=performance.getEntriesByType("navigation")[0]||function(){var n=performance.timing,o={entryType:"navigation",startTime:0};for(var a in n)a!=="navigationStart"&&a!=="toJSON"&&(o[a]=Math.max(n[a]-n.navigationStart,0));return o}();i.value=i.delta=r.responseStart,i.entries=[r],e(i)}catch{}},document.readyState==="complete"?setTimeout(t,0):addEventListener("pageshow",t)};export{q as getCLS,A as getFCP,I as getFID,R as getLCP,B as getTTFB};
